#macç”¨æˆ·è¯·å°†æ­¤æ–‡ä»¶å†…å®¹ç²˜è´´åˆ°CMakeList.txtæ‰“å¼€ï¼Œå¦‚é‡é¡¹ç›®æ„å»ºå¤±è´¥é—®é¢˜éœ€æ‰‹åŠ¨æ£€æŸ¥Qtè·¯å¾„è®¾ç½®
cmake_minimum_required(VERSION 3.16)
project(Project1 VERSION 0.1 LANGUAGES CXX)

# å¯ç”¨è‡ªåŠ¨å¤„ç† Qt ç›¸å…³æ–‡ä»¶
set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)

# C++ æ ‡å‡†è®¾ç½®
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Qt è·¯å¾„è®¾ç½®
if(NOT CMAKE_PREFIX_PATH)
    if(APPLE)
        set(QT_POSSIBLE_PATHS
            "$ENV{HOME}/Qt/6.9.0/macos"
            "$ENV{HOME}/Qt/6.8.0/macos"
            "$ENV{HOME}/Qt/5.15.2/clang_64"
        )
    endif()
    
    foreach(QT_PATH ${QT_POSSIBLE_PATHS})
        if(EXISTS "${QT_PATH}")
            set(CMAKE_PREFIX_PATH "${QT_PATH}")
            message(STATUS "Found Qt at: ${QT_PATH}")
            break()
        endif()
    endforeach()
endif()

# æŸ¥æ‰¾ Qt
find_package(QT NAMES Qt6 Qt5 REQUIRED COMPONENTS Widgets)
find_package(Qt${QT_VERSION_MAJOR} REQUIRED COMPONENTS Widgets)

# ğŸŒŸ æ ¹æ®å®é™…æ–‡ä»¶åˆ—è¡¨æ›´æ–°æºæ–‡ä»¶
set(PROJECT_SOURCES
    main.cpp
    mainwindow.cpp
    mainwindow.h
    mainwindow.ui
    canvas.cpp
    canvas.h
    circle.cpp
    circle.h
    calculator.h
    customizedoperation.cpp    
    customizedoperation.h         
    geometricobject.cpp
    geometricobject.h
    intersectioncreator.cpp
    intersectioncreator.h
    line.cpp
    line.h
    lineo.cpp
    lineo.h
    lineoo.cpp
    lineoo.h
    objecttype.h
    operation.cpp
    operation.h
    point.cpp
    point.h
    tools.cpp
    tools.h
    saveloadhelper.h
    saveloadhelper.cpp
    measurement.h
    measurement.cpp
)

# æ·»åŠ èµ„æºæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/icon.qrc")
    list(APPEND PROJECT_SOURCES "icon.qrc")
    message(STATUS "âœ… Found: icon.qrc")
endif()

# æ˜¾ç¤ºæºæ–‡ä»¶åˆ—è¡¨
message(STATUS "Project source files:")
foreach(source_file ${PROJECT_SOURCES})
    if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/${source_file}")
        message(STATUS "  âœ… ${source_file}")
    else()
        message(WARNING "  âŒ Missing: ${source_file}")
    endif()
endforeach()

# åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶
if(QT_VERSION_MAJOR EQUAL 6)
    qt_add_executable(Project1
        MANUAL_FINALIZATION
        ${PROJECT_SOURCES}
    )
    qt_finalize_executable(Project1)
else()
    add_executable(Project1 ${PROJECT_SOURCES})
endif()

# é“¾æ¥åº“
target_link_libraries(Project1 PRIVATE Qt${QT_VERSION_MAJOR}::Widgets)

message(STATUS "ğŸ¯ Project configured successfully!")
